<!-- Scaffolding generated by Casein v5.1.1.5 -->
<%= cloudinary_js_config %>

<div class="row">
	<div class="col-lg-8">
		<%= casein_text_field f, f.object, :name %>
	</div>
	<div class="col-lg-4">
		<%= casein_select f, f.object, :catagory, Production.catagories.keys, casein_sublabel: "Type of production" %>

	</div>
</div>
<%= casein_text_area f, f.object, :synopsis, class: 'wysihtml5', rows: 20 %>


<div class="row">
	<div class="col-lg-6">
		<%= casein_url_field f, f.object, :media_pack_link, casein_sublabel: "Insert a link" %>
	</div>
	<div class="col-lg-6">
		<%= casein_url_field f, f.object, :tech_spec_link, casein_sublabel: "Insert a link" %>
	</div>
</div>

<%= casein_text_area f, f.object, :tech_summary, class: 'wysihtml5', rows: 15 %>

<div class="row">
	<div class="col-lg-6">
		<p><b>Images</b></p>
		<div class="field">
		<p>
			<%= f.cl_image_upload :images, multiple: true %>
		</p>
	</div>
		<div id="progress_bar_box">
			<div id="progress_bar"></div>
			<div id="progress_percents"></div>
		</div>
		<div id="preview_images"></div>
	</div>
	<div class="col-lg-6">
		<%= casein_text_field f, f.object, :video_link %>
	</div>
</div>

<div>
	<% if @production.images.any? %>
		<b>Select images to delete </b>
		<p>
			<%= check_box_tag "select_all" %> Select all
		</p>
	</br>
	<div class="row">
		<% @production.images.each do |image| %>
		<div class="col-sm-3" style="margin-top: 20px">
			<%= check_box_tag image.id, "delete" %>
			<%= cl_image_tag(image.image.url, width: 170) %>
		</br>
		</div>
		<% end %>
	</div>
	<% end %>
</div>

<!--Scripts-->
<script type="text/javascript">
//select all checkboxes
  $(document).ready(function() {
    $('#select_all').click(function(event) {  //on click
      if(this.checked) { // check select status
        $('form input:checkbox').each(function() { //loop through each checkbox
          this.checked = true;  //select all checkboxes with class "checkbox1"
        });
      }else{
        $('form input:checkbox').each(function() { //loop through each checkbox
          this.checked = false; //deselect all checkboxes with class "checkbox1"
        });
      }
    });
		//cloudinary
    $('.cloudinary-fileupload').cloudinary_fileupload().on('cloudinarydone', function(e, data){
      $('#preview_images').append($.cloudinary.image(data.result.public_id, {width: 100, height: 100, crop: "fill"}));
    })
    .on('cloudinaryprogressall', function(e, data){
      $('#progress_bar_box').show();
      var percents = Math.round((data.loaded * 100.0) / data.total) + '%'
      $('#progress_percents').text(percents)
      $('#progress_bar').css('width', percents);
    })
    .on('fileuploadstop', function(){
      $('#progress_bar_box').hide(fadeOut);
    });
  });

</script>
