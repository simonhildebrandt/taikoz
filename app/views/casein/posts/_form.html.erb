<!-- Scaffolding generated by Casein v5.1.1.5 -->
<%= cloudinary_js_config %>

<div class="row">
	<div class="col-lg-8">
		<%= casein_text_field f, f.object, :title %>
	</div>
	<div class="col-lg-4">
		<%= casein_text_field f, f.object, :author %>
		<%= casein_select f, f.object, :post_status, ["Draft", "Published"] %>
	</div>
</div>

<div class="row">
	<div class="col-lg-12">
		<%= casein_text_area_big f, f.object, :content, rows: 20, class: 'wysihtml5' %>
	</div>
</div>
<div class="row">
	<div class="col-md-4">
		<label>
			Upload Hero Image
		</label>
			<%# f.file_field :image_1 %>
			<%= f.cl_image_upload :image_1, tags: "post_hero_image" %>
			<% if @post.image_1? %>
				<p>
					<label>
						<%= f.check_box :remove_image_1 %>
						Remove Image
					</label>
					<%= cl_image_tag(@post.image_1.url, width: 170) %>
				</p>
			<% end %>
</br>
			<p><b>Upload Gallery Images</b></p>
			<div class="field">
			<p>
				<%= f.cl_image_upload :images, multiple: true %>
			</p>
		</div>
			<div id="progress_bar_box">
				<div id="progress_bar"></div>
				<div id="progress_percents"></div>
			</div>
			<div id="preview_images"></div>

		</div>
		<div class="col-md-8">
			<% if @post.images.any? %>
				<b>Select images to delete </b>
				<p>
					<%= check_box_tag "select_all" %> Select all
				</p>
			</br>

				<% @post.images.each do |image| %>
				<div class="col-sm-3">
					<%= check_box_tag image.id, "delete" %>
					<%= cl_image_tag(image.image.url, width: 170) %>
				</br>
				</div>
				<% end %>


			<% end %>
		</div>
</div>

<!--Scripts-->
<script type="text/javascript">
//select all checkboxes
  $(document).ready(function() {
    $('#select_all').click(function(event) {  //on click
      if(this.checked) { // check select status
        $('form input:checkbox').each(function() { //loop through each checkbox
          this.checked = true;  //select all checkboxes with class "checkbox1"
        });
      }else{
        $('form input:checkbox').each(function() { //loop through each checkbox
          this.checked = false; //deselect all checkboxes with class "checkbox1"
        });
      }
    });
		//cloudinary
    $('.cloudinary-fileupload').cloudinary_fileupload().on('cloudinarydone', function(e, data){
      $('#preview_images').append($.cloudinary.image(data.result.public_id, {width: 100, height: 100, crop: "fill"}));
    })
    .on('cloudinaryprogressall', function(e, data){
      $('#progress_bar_box').show();
      var percents = Math.round((data.loaded * 100.0) / data.total) + '%'
      $('#progress_percents').text(percents)
      $('#progress_bar').css('width', percents);
    })
    .on('fileuploadstop', function(){
      $('#progress_bar_box').hide(fadeOut);
    });
  });

</script>
